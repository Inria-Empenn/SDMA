
# Statistical Inference for Same Data Meta-Analysis for Neuroimaging Multiverse Analyzes

Jeremy Lefort-Besnard, Thomas E. Nichols°, Camille Maumet°

°These authors contributed equally to this work

## Table of contents
   * [How to cite?](#how-to-cite)
   * [Contents overview](#contents-overview)
   * [Reproducing figures and tables](#reproducing-figures-and-tables)
      * [Table 1](#table-1)
      * [Table 2](#table-2)
      * [Table 3](#table-3)
      * [Fig. 1](#fig-1)
      * [Fig. 2](#fig-2)
      * [Fig. 3](#fig-3)
      * [Fig. 4](#fig-4)
   * [Reproducing full analysis](#reproducing-full-analysis)

## How to cite?

See [CITATION](CITATION).

# Contents overview

This repository includes the codes necessary to reproduce the analyses described in the paper "Statistical Inference for Same Data Meta-Analysis for Neuroimaging Multiverse Analyses". The repository is structured as follows:
- `CITATION/`: How to cite our work.
- `data/`: Raw data used in the analyses.
- `figures/`: Summary and derived data used to create figures.
- `results/`: Summary and derived data used to create tables.
- `src/`: Source code for simulations and analyses.

## Reproducing figures and tables

Please note that the "NARPS" and "HCP Young Adult" multiverse outputs must be downloaded and stored in "SDMA/data/NARPS" and "SDMA/data/HCP".
"NARPS" multiverse outputs can be downloaded from [NeuroVault](https://www.neurovault.org) [(Gorgolewski & al, 2015)](https://www.frontiersin.org/articles/10.3389/fninf.2015.00008/full)[NARPS](https://github.com/poldrack/narps/tree/master/ImageAnalyses).
"HCP Young Adult" multiverse output can be downloaded from [Germani et al. 2023](https://arxiv.org/pdf/2312.14493)

Additionally, the following scripts must be run beforehand:

1. "SDMA/src/extract_HCP_data.py" for preprocessing and computation of the intersectional mask.
2. "SDMA/src/extract_NARPS_data.py" for preprocessing and removal of non-included participants.
3. "SDMA/src/intersectional_mask.py" to compute the intersectional mask between all NARPS team outputs.

### Fig. 1
This figure is saved at "SDMA/figures/SIMULATIONS/simulations_visualisation.pdf", generated by the script "SDMA/scr/SDMA_in_generated_data.py"

### Fig. 2
This figure is saved at "SDMA/figures/SIMULATIONS/J20000_K20_Corr0.8.pdf", generated by the script "SDMA/scr/SDMA_in_generated_data.py"

### Fig. 3
This figure combines "SDMA/figures/NARPS/hyp1/SDMA/thresholded_map_hyp1.png" generated by the script "SDMA/scr/SDMA_in_NARPS.py" and "SDMA/figures/HCP/thresholded_map_hyp" generated by the script "SDMA/scr/SDMA_in_HCP.py".

### Fig. 4
This figure combines "SDMA/figures/NARPS/hyp1/cluster_analysis/3clusters/Fig4.png" and "SDMA/figures/NARPS/hyp1/cluster_analysis/3clusters/per_cluster_weights_3.png" generated by the script "SDMA/scr/cluster_analysis_in_NARPS.py".

### Table 1, 2 and 3
The results for these tables can be found in the files "SDMA/results/NARPS/hyp1/spatial_homogeneity/Frobenius_score_NARPS.xlsx" and "SDMA/results/HCP/spatial_homogeneity/Frobenius_score_HCP.xlsx", generated by the scripts "SDMA/scr/spatial_homogeneity_in_NARPS.py" and "SDMA/scr/spatial_homogeneity_in_HCP.py", respectively.

