### Code for reproducing the key results of our paper: <br>_Systematic review and evaluation of meta-analysis methods for pipeline comparison_

Lefort-Besnard J, Nichols T, Maumet C

Please cite this paper when using the code for your research.
You can clone this repository by:
git clone https://github.com/JLefortBesnard/SDMA.git

---

### MA outputs in generated data

#### Generated data

![image link](results_in_generated_data/data_visualisation.png)
&nbsp;

#### PP plots

![image link](results_in_generated_data/pp_plot_Null.png)
![image link](results_in_generated_data/pp_plot_Null_correlated_80%25.png)
![image link](results_in_generated_data/pp_plot_Null_correlated_50%25.png)
![image link](results_in_generated_data/pp_plot_Null_correlated_20%25.png)
![image link](results_in_generated_data/pp_plot_Non-null_heterogeneous_voxels.png)
![image link](results_in_generated_data/pp_plot_Non-null_heterogeneous_pipelines_20%25.png)
![image link](results_in_generated_data/pp_plot_Non-null_heterogeneous_pipelines_30%25.png)
![image link](results_in_generated_data/pp_plot_Non-null_heterogeneous_pipelines_50%25.png)
![image link](results_in_generated_data/pp_plot_Non-null_heterogeneous_pipelines_(%2B3_indep).png)
&nbsp;

---

#### PP plots multiverse (10 different seeds)

![image link](results_in_generated_data/pp_plot_multiverse_Null.png)
![image link](results_in_generated_data/pp_plot_multiverse_Null_correlated_80%25.png)
![image link](results_in_generated_data/pp_plot_multiverse_Null_correlated_50%25.png)
![image link](results_in_generated_data/pp_plot_multiverse_Null_correlated_20%25.png)
![image link](results_in_generated_data/pp_plot_multiverse_Non-null_heterogeneous_voxels.png)
![image link](results_in_generated_data/pp_plot_multiverse_Non-null_heterogeneous_pipelines_20%25.png)
![image link](results_in_generated_data/pp_plot_multiverse_Non-null_heterogeneous_pipelines_30%25.png)
![image link](results_in_generated_data/pp_plot_multiverse_Non-null_heterogeneous_pipelines_50%25.png)
![image link](results_in_generated_data/pp_plot_multiverse_Non-null_heterogeneous_pipelines_(%2B3_indep).png)
&nbsp;

---


#### Weights per pipeline per MA models
![image link](results_in_generated_data/weights_in_Null.png)
![image link](results_in_generated_data/weights_in_Null_correlated_80%25.png)
![image link](results_in_generated_data/weights_in_Null_correlated_50%25.png)
![image link](results_in_generated_data/weights_in_Null_correlated_20%25.png)
![image link](results_in_generated_data/weights_in_Non-null_heterogeneous_voxels.png)
![image link](results_in_generated_data/weights_in_Non-null_heterogeneous_pipelines_20%25.png)
![image link](results_in_generated_data/weights_in_Non-null_heterogeneous_pipelines_30%25.png)
![image link](results_in_generated_data/weights_in_Non-null_heterogeneous_pipelines_50%25.png)
![image link](results_in_generated_data/weights_in_Non-null_heterogeneous_pipelines_(%2B3_indep).png)
&nbsp;

---

&nbsp;
### MA outputs in NARPS data

#### frequency
![image link](results_in_Narps_data/hyp1_MA_outputs.png)
![image link](results_in_Narps_data/hyp2_MA_outputs.png)
![image link](results_in_Narps_data/hyp5_MA_outputs.png)
![image link](results_in_Narps_data/hyp6_MA_outputs.png)
![image link](results_in_Narps_data/hyp7_MA_outputs.png)
![image link](results_in_Narps_data/hyp8_MA_outputs.png)
![image link](results_in_Narps_data/hyp9_MA_outputs.png)

&nbsp;
---
&nbsp;

#### brain maps
expected results: Positive effect in ventromedial PFC hyp 1, 2, and negative for 5, 6 
![image link](results_in_Narps_data/VMPFC_AALmask.png)
expected results: Positive effect in ventral striatum for hyp 3, 4 (same maps as 1, 2) 
![image link](results_in_Narps_data/VentralStriatum_AALmask.png)
expected results: Positive effect in amygdala hyp 7, 8, 9
![image link](results_in_Narps_data/Amygdala_AALmask.png)


![image link](results_in_Narps_data/thresholded_map_hyp1_nofdr.png)
Similarities and contrast among SDMA models
![image link](results_in_Narps_data/similarity_maps_hyp1.png)
![image link](results_in_Narps_data/contrast_maps_hyp1.png)

![image link](results_in_Narps_data/thresholded_map_hyp2_nofdr.png)
Similarities and contrast among SDMA models
![image link](results_in_Narps_data/similarity_maps_hyp2.png)
![image link](results_in_Narps_data/contrast_maps_hyp2.png)

![image link](results_in_Narps_data/thresholded_map_hyp5_nofdr.png)
Similarities and contrast among SDMA models
![image link](results_in_Narps_data/similarity_maps_hyp5.png)
![image link](results_in_Narps_data/contrast_maps_hyp5.png)

![image link](results_in_Narps_data/thresholded_map_hyp6_nofdr.png)
Similarities and contrast among SDMA models
![image link](results_in_Narps_data/similarity_maps_hyp6.png)
![image link](results_in_Narps_data/contrast_maps_hyp6.png)

![image link](results_in_Narps_data/thresholded_map_hyp7_nofdr.png)
Similarities and contrast among SDMA models
![image link](results_in_Narps_data/similarity_maps_hyp7.png)
![image link](results_in_Narps_data/contrast_maps_hyp7.png)

![image link](results_in_Narps_data/thresholded_map_hyp8_nofdr.png)
Similarities and contrast among SDMA models
![image link](results_in_Narps_data/similarity_maps_hyp8.png)
![image link](results_in_Narps_data/contrast_maps_hyp8.png)

![image link](results_in_Narps_data/thresholded_map_hyp9_nofdr.png)
Similarities and contrast among SDMA models
![image link](results_in_Narps_data/similarity_maps_hyp9.png)
![image link](results_in_Narps_data/contrast_maps_hyp9.png)

&nbsp;
---
&nbsp;

#### Weights per pipeline per MA models
![image link](results_in_Narps_data/weights_in_hyp_1.png)
![image link](results_in_Narps_data/weights_in_hyp_2.png)
![image link](results_in_Narps_data/weights_in_hyp_5.png)
![image link](results_in_Narps_data/weights_in_hyp_6.png)
![image link](results_in_Narps_data/weights_in_hyp_7.png)
![image link](results_in_Narps_data/weights_in_hyp_8.png)
![image link](results_in_Narps_data/weights_in_hyp_9.png)


&nbsp;
---
&nbsp;

#### Resample brain maps
![image link](results_in_Narps_data/Hyp1_resampled_maps_part_0.png)
![image link](results_in_Narps_data/Hyp1_resampled_maps_part_1.png)
![image link](results_in_Narps_data/Hyp1_resampled_maps_part_2.png)
![image link](results_in_Narps_data/Hyp2_resampled_maps_part_0.png)
![image link](results_in_Narps_data/Hyp2_resampled_maps_part_1.png)
![image link](results_in_Narps_data/Hyp2_resampled_maps_part_2.png)
![image link](results_in_Narps_data/Hyp5_resampled_maps_part_0.png)
![image link](results_in_Narps_data/Hyp5_resampled_maps_part_1.png)
![image link](results_in_Narps_data/Hyp5_resampled_maps_part_2.png)
![image link](results_in_Narps_data/Hyp6_resampled_maps_part_0.png)
![image link](results_in_Narps_data/Hyp6_resampled_maps_part_1.png)
![image link](results_in_Narps_data/Hyp6_resampled_maps_part_2.png)
![image link](results_in_Narps_data/Hyp7_resampled_maps_part_0.png)
![image link](results_in_Narps_data/Hyp7_resampled_maps_part_1.png)
![image link](results_in_Narps_data/Hyp7_resampled_maps_part_2.png)
![image link](results_in_Narps_data/Hyp7_resampled_maps_part_0.png)
![image link](results_in_Narps_data/Hyp7_resampled_maps_part_1.png)
![image link](results_in_Narps_data/Hyp7_resampled_maps_part_2.png)
![image link](results_in_Narps_data/Hyp8_resampled_maps_part_0.png)
![image link](results_in_Narps_data/Hyp8_resampled_maps_part_1.png)
![image link](results_in_Narps_data/Hyp8_resampled_maps_part_2.png)
![image link](results_in_Narps_data/Hyp9_resampled_maps_part_0.png)
![image link](results_in_Narps_data/Hyp9_resampled_maps_part_1.png)
![image link](results_in_Narps_data/Hyp9_resampled_maps_part_2.png)
![image link](results_in_Narps_data/Hyp1_resampled_maps_part_0.png)
![image link](results_in_Narps_data/Hyp1_resampled_maps_part_1.png)
![image link](results_in_Narps_data/Hyp1_resampled_maps_part_2.png)
